Ext.define("Ozone.components.draggable.DraggableWidgetView",{extend:"Ext.AbstractPlugin",itemSelector:null,dragNodeSelector:null,cmpToHideAndShow:null,dashboardContainer:null,showAfterLaunch:null,init:function(a){a.on("afterrender",this.setupDragZone,this,{single:true});a.on("destroy",this.cleanup,this)},cleanup:function(){this.dragZone.unreg()},setupDragZone:function(a){this.dragZone=new Ext.dd.DragZone(a.getEl(),{isTarget:false,panes:null,ddGroup:"widgets",itemSelector:this.itemSelector,dragNodeSelector:this.dragNodeSelector,getDragData:function(c){var d=c.getTarget(this.itemSelector),e,b;if(d){e=Ext.get(d);b=Ext.getCmp(e.parent().id);return{ddel:e.down(this.dragNodeSelector).dom.cloneNode(true),widgetModel:[b.getRecord(d)]}}},onStartDrag:Ext.bind(this.onStartDrag,this),afterValidDrop:Ext.bind(this.afterDrop,this),afterInvalidDrop:Ext.bind(this.afterDrop,this)});this.dashboardContainer=a.dashboardContainer;this.cmpToHideAndShow=a.isXType("window")?a:a.up("window")},onStartDrag:function(){this.dashboardContainer.activeDashboard.enableWidgetDragAndDrop();this.cmpToHideAndShow.hide();this.showAfterLaunch&&this.dashboardContainer.activeDashboard.on(OWF.Events.Widget.AFTER_LAUNCH,this.showWindow,this)},afterDrop:function(){this.dashboardContainer.activeDashboard.disableWidgetDragAndDrop()},showWindow:function(){this.dashboardContainer.activeDashboard.un(OWF.Events.Widget.AFTER_LAUNCH,this.showWindow,this);this.cmpToHideAndShow.show()}});