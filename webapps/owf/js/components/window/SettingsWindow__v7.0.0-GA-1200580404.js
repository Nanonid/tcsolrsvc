Ext.define("Ozone.components.SettingsWindow",{extend:"Ozone.components.window.ModalWindow",alias:["widget.settingswindow","widget.Ozone.components.SettingsWindow"],title:"Settings",id:"settingsWindow",cls:"system-window settings-window",iconCls:"settings-header-icon",ui:"system-window",layout:"auto",closable:false,resizable:false,draggable:false,modal:true,modalAutoClose:true,shadow:false,autoScroll:false,minToolsInRow:2,maxToolsInRow:5,items:[],plugins:new Ozone.components.keys.HotKeyComponent(Ozone.components.keys.HotKeys.SETTINGS),store:Ext.create("Ext.data.Store",{fields:["name","image","caption"],data:[{name:"Themes",image:"themes/common/images/settings/ThemeIcon.png"},{name:"Widgets",image:"themes/common/images/settings/WidgetsIcon.png"}]}),initComponent:function(){var a=this;this.view=Ext.create("Ozone.components.view.ToolDataView",{store:this.store,multiSelect:false,singleSelect:true,autoScroll:true,listeners:{refresh:{fn:this.setupModalFocus,scope:this},viewready:{fn:this.updateWindowSize,scope:this,single:true}}});this.items=[this.view];this.on("resize",this.center,this);this.callParent(arguments)},setupModalFocus:function(){var a=this.down("tooldataview");this.setupFocus(Ext.get(a.getNode(0)),Ext.get(a.getNode(a.store.getCount()-1)));Ext.defer(function(){Ext.get(a.getNode(0)).focus()},100)},callBtnHandler:function(b,a){switch(b){case"Themes":this.themeBtnHandler(a);break;case"Widgets":this.widgetsBtnHandler(a);break}this.close()},themeBtnHandler:function(a){Ext.create("Ozone.components.theming.ThemeSwitcherWindow",{ownerCt:this.dashboardContainer,dashboardContainer:this.dashboardContainer,height:650,width:810,title:Ozone.layout.ThemeSwitcherWindowConstants.title,modal:true,layout:"border",border:false,bodyBorder:false}).show()},widgetsBtnHandler:function(b){var c="manageWidgetsWindowId";var d=Ext.getCmp(c);if(!d){var a={id:c,title:Ozone.layout.tooltipString.carouselManageWidgetsTitle,ownerCt:this.dashboardContainer,dashboardContainer:this.dashboardContainer,constrain:Ext.isIE,constrainHeader:true,cls:"manageContainer",iconCls:"manageWidgetsContainer-header-icon",draggable:true,items:[{xtype:"owfManageWidgetsContainer",dashboardContainer:this.dashboardContainer,winId:c}],width:593,height:425};d=Ext.widget("managerwindow",a)}d.on("beforeclose",function(e){e.destroy()});d.show();Ext.defer(d.focus,500,d)},updateWindowSize:function(e){var h,d,c;c=e.getNode(0);if(!c){return}var b=Ext.get(c),f=b.getMargin("r"),a=e.getStore().getCount(),g=0;h=b.getWidth();if(a<this.minToolsInRow){g=this.minToolsInRow}else{if(a>this.maxToolsInRow){g=this.maxToolsInRow}else{g=a}}d=(h+f)*g;this.view.doComponentLayout(d)}});