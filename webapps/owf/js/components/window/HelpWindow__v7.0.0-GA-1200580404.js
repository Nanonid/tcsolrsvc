Ext.define("Ozone.components.window.HelpWindow",{extend:"Ext.window.Window",alias:["widget.helpwindow","widget.Ozone.components.window.HelpWindow"],id:"helpWindow",title:"Help",closable:true,maximizable:true,autoScroll:false,defaultFocus:"helpTreeView",height:600,width:900,mixins:{circularFocus:"Ozone.components.focusable.CircularFocus"},plugins:new Ozone.components.keys.HotKeyComponent(Ozone.components.keys.HotKeys.HELP),initComponent:function(){function a(d,b,f,c,g){if(b.get("leaf")){this.down("#helpPanel").getEl().set({src:"help"+b.get("path")})}}Ext.apply(this,{layout:{type:"border"},items:[{xtype:"treepanel",preventHeader:true,viewConfig:{plugins:new Ozone.components.focusable.Focusable(),itemId:"helpTreeView",listeners:{itemclick:a,itemkeydown:function(d,b,f,c,g){switch(g.getKey()){case g.ENTER:case g.SPACE:a.apply(this,arguments)}},scope:this}},store:Ext.create("Ext.data.TreeStore",{fields:["text","path"],proxy:{type:"ajax",url:"helpFiles"},reader:{type:"json",root:"children"},autoLoad:true}),rootVisible:false,region:"west",split:true,collapsible:true,collapseMode:"mini",flex:1,listeners:{load:{fn:function(){var b=this.down("#helpTreeView");if(b.getSelectedNodes().length===0&&b.getStore().getCount()>0){b.select(0);b.fireEvent("itemclick",this,b.getStore().getAt(0),b.getNode(0),0,{})}},scope:this}}},{flex:2,region:"center",xtype:"component",itemId:"helpPanel",cls:"helpPanel",autoEl:{tag:"iframe"},plugins:new Ozone.components.focusable.Focusable(),autoScroll:true}],dockedItems:[{xtype:"focuscatch",itemId:"focusCatch",dock:"bottom"}],listeners:{afterrender:function(c){var b=c.getComponent("focusCatch").getEl();c.setupFocus(c.down("#helpTreeView").getEl(),b);c.mon(b,{focus:function(){this.getEl().addCls("x-focus")},blur:function(){this.getEl().removeCls("x-focus")},scope:c});c.mon(c.getEl(),"keydown",function(d){if(!(d.altKey&&d.shiftKey)){return}switch(d.getKey()){case d.UP:d.stopEvent();this.maximize();break;case d.DOWN:d.stopEvent();this.restore();break}},c)},resize:function(b){b.syncShadow()},beforeclose:function(c,b){c.down("#helpPanel").getEl().set({src:""})}}});this.dashboardContainer&&this.on("show",function(){this.dashboardContainer.modalWindowManager.register(this);this.dashboardContainer.modalWindowManager.bringToFront(this)});this.callParent(arguments)}});