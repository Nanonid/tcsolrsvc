Ext.define("Ozone.components.panel.WidgetHeader",{extend:"Ext.panel.Header",alias:["widget.widgetheader","widget.Ozone.components.panel.WidgetHeader"],defaultType:"widgettool",cls:"widgetheader",inactiveCls:"x-tab-top-inactive",initComponent:function(){var d=this,f,c,b,e;d.indicateDragCls=d.baseCls+"-draggable";d.title=Ext.htmlEncode(d.title)||"&#160;";d.tools=d.tools||[];d.items=d.items||[];d.orientation=d.orientation||"horizontal";d.dock=(d.dock)?d.dock:(d.orientation=="horizontal")?"top":"left";d.addClsWithUI(d.orientation);d.addClsWithUI(d.dock);d.addChildEls("body");if(!Ext.isEmpty(d.iconCls)||!Ext.isEmpty(d.icon)){d.initIconCmp();d.items.push(d.iconCmp)}if(d.orientation=="vertical"){if(Ext.isIE6||Ext.isIE7){d.width=this.width||24}else{if(Ext.isIEQuirks){d.width=this.width||25}}d.layout={type:"vbox",align:"center",clearInnerCtOnLayout:true,bindToOwnerCtContainer:false};d.textConfig={cls:d.baseCls+"-text",type:"text",text:d.title,rotate:{degrees:90}};e=d.ui;if(Ext.isArray(e)){e=e[0]}f=Ext.util.CSS.getRule("."+d.baseCls+"-text-"+e);if(f){c=f.style}if(c){Ext.apply(d.textConfig,{"font-family":c.fontFamily,"font-weight":c.fontWeight,"font-size":c.fontSize,fill:c.color})}d.titleCmp=Ext.create("Ext.draw.Component",{ariaRole:"heading",focusable:false,viewBox:false,flex:1,autoSize:true,margins:"5 0 0 0",items:[d.textConfig],renderSelectors:{textEl:"."+d.baseCls+"-text"}})}else{d.layout={type:"owfhbox",overflowHandler:"Ozone.components.container.boxOverflow.Menu",align:"middle"};function a(j){var g=d,h=g.titleCmp;j.stopEvent();var i=Ext.create("Ext.Editor",{updateEl:false,width:h.getWidth(),height:h.getHeight(),parentEl:h.getEl(),shadow:false,titleCmp:h,field:{xtype:"textfield",allowBlank:false},listeners:{specialkey:{fn:function(l,m,k){if(k.getKey()===k.ENTER){k.preventDefault();g.titleCmp.focus()}},scope:g},afterrender:function(k){k.mon(k.getEl(),"keydown",function(l){l.stopPropagation()});Ozone.components.focusable.EscCloseHelper.prototype.setupFocusOnEsc.call(k,g.titleCmp.getFocusEl(),true)}}});i.startEdit(h.textEl,Ext.htmlDecode(d.title));i.alignTo(g.iconCmp,"l-r");i.on("complete",function(m,n,k,l){g.ownerCt.setTitle(n);m.clearListeners();m.destroy()})}d.titleCmp=Ext.create("Ext.Component",{xtype:"component",ariaRole:"heading",plugins:[new Ozone.components.focusable.Focusable()],minWidth:66,flex:1,cls:d.baseCls+"-text-container",renderTpl:['<span id="{id}-textEl" class="{cls}-text {cls}-text-{ui}">{title}</span>'],renderData:{title:d.title,cls:d.baseCls,ui:d.ui},childEls:["textEl"],renderSelectors:{textEl:"."+d.baseCls+"-text"},listeners:{afterrender:{fn:function(h){var j=false;var i={text:this.title};this.setTooltip(i);h.keyMap=new Ext.util.KeyMap(h.el,[{key:[Ext.EventObject.ENTER,Ext.EventObject.SPACE],handler:function(l,k){a(k)}}]);h.mon(h.textEl,"dblclick",a);h.mon(h.getEl(),"focus",function(){if(j){this.blur()}},h.getEl());h.mon(h.getEl(),"mousedown",function(k){j=true});var g=function(){j=false};h.mon(h.getEl(),{mouseup:g,mouseout:g})},scope:this,single:true},destroy:{fn:function(g){this.clearTip()},scope:this}}})}d.items.push(d.titleCmp);d.spacer=Ext.create("Ext.Component",{itemId:"spacer",xtype:"component",html:"&nbsp;",width:14,focusable:false});d.items.push(d.spacer);d.items=d.items.concat(d.tools);Ozone.components.panel.WidgetHeader.superclass.superclass.initComponent.apply(this,arguments)},onClick:function(a){this.fireEvent("click",a)},initIconCmp:function(){this.iconCmp=Ext.create("Ext.Component",{focusable:false,renderTpl:['<div><img id="{id}-iconEl" alt="" src="{icon}" class="{cls}-icon {iconCls}"/></div>'],renderData:{icon:this.icon!=null?this.icon:Ext.BLANK_IMAGE_URL,cls:this.baseCls,iconCls:this.iconCls,orientation:this.orientation,singleton:this.singleton},childEls:["iconEl"],renderSelectors:{iconEl:"."+this.baseCls+"-icon"},icon:this.icon,iconCls:this.iconCls})},setIcon:function(b){this.icon=b;if(!this.iconCmp){this.initIconCmp();this.insert(0,this.iconCmp)}else{if(!b||!b.length){this.iconCmp.destroy()}else{var c=this.iconCmp,a=c.iconEl;a.set({src:b});c.icon=b}}},setTooltip:function(d,a){var c=this;if(c.rendered){if(!a){c.clearTip()}if(Ext.isObject(d)){var b=Ext.apply({target:this.titleCmp.textEl,anchor:"bottom"},d);b.html=b.text;c.tooltip=Ext.create("Ozone.components.tip.ToolTip",b)}else{c.btnEl.dom.setAttribute("data-"+this.tooltipType,d)}}else{c.tooltip=d}return c},clearTip:function(){if(Ext.isObject(this.tooltip)){this.tooltip.destroy()}},setTitle:function(a){a=Ext.htmlEncode(a);this.callParent([a]);this.setTooltip({text:a})},activate:function(b){var a=this;a.active=true;a.removeCls(a.inactiveCls);if(b!==true){a.fireEvent("activate",a)}},deactivate:function(b){var a=this;a.active=false;a.addCls(a.inactiveCls);if(b!==true){a.fireEvent("deactivate",a)}},insertTool:function(b,c){var a=this.items.indexOf(this.spacer)+1;if(c){a+=c}this.tools.push(this.insert(a,b))},insertMenuItem:function(c,d){var a=this.items.indexOf(this.spacer);if(d){a=this.items.indexOf(this.editor)+1+d}var b=Ext.ClassManager.instantiateByAlias("widget."+c.xtype,c);this.insert(a,b)},isXType:function(b,a){if(b=="header"){return this.callParent([b,false])}else{return this.callParent(arguments)}}});