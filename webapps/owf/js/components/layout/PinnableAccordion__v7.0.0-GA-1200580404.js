Ext.define("Ozone.components.layout.PinnableAccordion",{extend:"Ext.layout.container.Accordion",alias:"layout.pinnableaccordion",renderItems:function(g,e){var h=this,f=g.length,c=0,d,b=h.getLayoutTargetSize(),j=[],a;for(;c<f;c++){d=g[c];if(!d.rendered){j.push(d);if(h.collapseFirst){d.collapseFirst=h.collapseFirst}if(h.hideCollapseTool){d.hideCollapseTool=h.hideCollapseTool;d.titleCollapse=true}else{if(h.titleCollapse){d.titleCollapse=h.titleCollapse}}delete d.hideHeader;d.collapsible=true;d.title=d.title||"&#160;";d.setBorder(false);d.width=b.width;if(h.fill){delete d.height;delete d.flex;if(d.collapsed===false){d.flex=1}else{d.collapsed=true}}else{delete d.flex;d.animCollapse=h.initialAnimate;d.autoHeight=true;d.autoScroll=false}}}Ozone.components.layout.PinnableAccordion.superclass.superclass.renderItems.apply(this,arguments);f=j.length;for(c=0;c<f;c++){d=j[c];delete d.width;d.header.addCls(Ext.baseCSSPrefix+"accordion-hd");d.body.addCls(Ext.baseCSSPrefix+"accordion-body");if(h.fill){h.owner.mon(d,{show:h.onComponentShow,beforeexpand:h.onComponentExpand,beforecollapse:h.onComponentCollapse,scope:h})}}},onComponentExpand:function(f){var e=this,d=e.owner.items.items,a=d.length,c=0,b;for(;c<a;c++){b=d[c];if(b===f&&b.collapsed&&!b.pinned){e.setExpanded(b)}else{if(!e.multi&&(b.rendered&&b.header.rendered&&b!==f&&!b.collapsed)){e.setCollapsed(b)}}}e.animate=e.initialAnimate;e.layout();e.animate=false;return false},onComponentCollapse:function(b){var c=this,d=b.next()||b.prev(),a=c.multi?c.owner.query(">panel:not([collapsed])"):[];if(c.multi&&!c.pinned){c.setCollapsed(b);c.animate=c.initialAnimate;c.layout();c.animate=false}else{if(d&&!c.pinned){c.onComponentExpand(d)}}return false},setCollapsed:function(a){this.callParent(arguments);var e=a.header.layout.overflowHandler.menu;if(a.collapseTool&&e!=null&&e.items!=null&&e.items.getCount()>0){var d=null;var c=e.items;for(var b=0;b<c.getCount();b++){if(c.getAt(b).type.indexOf("collapse-")==0){d=c.getAt(b);break}}if(d){d.setType("expand-"+a.getOppositeDirection(a.collapseDirection))}c=a.header.layout.overflowHandler.menuItems;for(var b=0;b<c.length;b++){if(c[b].type.indexOf("collapse-")==0){d=c[b];break}}if(d){d.setType("expand-"+a.getOppositeDirection(a.collapseDirection))}}},setExpanded:function(a){this.callParent(arguments);var e=a.header.layout.overflowHandler.menu;if(a.collapseTool&&e!=null&&e.items!=null&&e.items.getCount()>0){var d=null;var c=e.items;for(var b=0;b<c.getCount();b++){if(c.getAt(b).type.indexOf("expand-")==0){d=c.getAt(b);break}}if(d){d.setType("collapse-"+a.collapseDirection)}c=a.header.layout.overflowHandler.menuItems;for(var b=0;b<c.length;b++){if(c[b].type.indexOf("expand-")==0){d=c[b];break}}if(d){d.setType("collapse-"+a.collapseDirection)}}}});