Ext.define("Ozone.components.pane.DesktopPane",{extend:"Ozone.components.pane.Pane",alias:["widget.desktoppane","widget.Ozone.components.pane.DesktopPane"],plugins:[new Ozone.plugins.pane.DesktopPane()],activeWidget:null,componentCls:"desktoppane pane",type:"desktop",getTaskBar:function(){return this.getDockedItems('toolbar[dock="bottom"]')[0]},initComponent:function(){var a=this;this.dockedItems=[{xtype:"widgettoolbar",itemId:"taskbar",cls:"taskbar",dock:"bottom",layout:{type:"hbox",align:"stretch",autoSize:false,clearInnerCtOnLayout:true,overflowHandler:"Scroller",scollerResetPerformed:false},items:[],listeners:{resize:{fn:a.attemptScrollerReset,scope:a}}}];a.callParent(arguments)},getWidgets:function(){var d=[],c=this.stateStore;for(var b=0,a=c.getCount();b<a;b++){d.push(Ext.getCmp(c.getAt(b).data.uniqueId))}return Ext.Array.clean(d)},activateWidget:function(b,a,c){if(b.rendered===false||(b.rendered===true&&b.floating)){b.minimized===true?b.restoreFromMinimize(a):b.focus(false,false,a,c)}this.dashboard.updateActiveWidget(b);return true},launchPreviouslyOpenedWidgets:function(){var g,h,f;this._launchingPreviouslyOpenedWidgets=true;this._widgetCmps={};this._sortedUniqueIds=[];if(this.widgets.length>0){this.stateStore.sort("zIndex","ASC");for(var d=0,a=this.stateStore.getCount();d<a;d++){var c=this.stateStore.getAt(d);if(!c.get("floatingWidget")&&!c.get("background")){this._sortedUniqueIds.push(c.get("uniqueId"))}}this.stateStore.sort("statePosition","ASC")}g=this.launchWidgets(this.stateStore.data.items);for(var d=0,a=this._sortedUniqueIds.length;d<a;d++){var b=Ext.getCmp(this._sortedUniqueIds[d]);if(!b){continue}if(d===0){h=b}if(f){f.on("show",function(i){return function(){e(i)}}(b),null,{single:true})}f=b}if(h){e(h)}delete this._sortedUniqueIds;delete this._widgetCmps;delete this._launchingPreviouslyOpenedWidgets;return g;function e(i){i.show();if(i.model.get("minimized")){i.minimize()}else{if(i.model.get("maximized")){i.maximize()}}}},launchWidget:function(b,a,e,d,c){this.launchFloatingWidget(b,a,e,d,c,true)},createTaskbarComponent:function(b){var a=this.getTaskBar().add({xtype:"widgettoolbaritem",widget:b});b.fireEvent("toolbaritem:created",a)},attemptScrollerReset:function(c){if(!c.layout.scollerResetPerformed){var a=c.layout.overflowHandler;if(a!=undefined){var b=a.afterScroller;var d=a.beforeScroller;if((d!=undefined)&&(b!=undefined)){if((!d.isDisplayed())&&(!b.isDisplayed())){a.scrollTo(0,false);c.layout.scollerResetPerformed=true}}else{a.on("scroll",function(g,f,e){this.layout.scollerResetPerformed=false},c)}}}},maximizeCollapseWidget:function(a){a.minimized?a.restoreFromMinimize():a.maximize()},minimizeExpandWidget:function(a){a.maximized?a.restore():a.minimize()},moveWidgetUp:function(a){a&&a.moveUp()},moveWidgetRight:function(a){a&&a.moveRight(a.renderTo.getWidth())},moveWidgetDown:function(a){a&&a.moveDown(a.renderTo.getHeight())},moveWidgetLeft:function(a){a&&a.moveLeft()}});