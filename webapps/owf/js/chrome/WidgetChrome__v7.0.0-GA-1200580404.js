var Ozone=Ozone?Ozone:{};Ozone.chrome=Ozone.chrome?Ozone.chrome:{};Ozone.chrome.WidgetChrome=function(a){if(Ozone.chrome.WidgetChrome.instance==null){var b=this;b.channelName="Ozone._WidgetChromeChannel";b.version=Ozone.version.owfversion+Ozone.version.widgetChrome;b.items={};b.registerChromeMenu=function(d){b.items[d.itemId!=null?d.itemId:d.id]=d;if(d.menu){for(var e=0;e<d.menu.items.length;e++){var f=d.menu.items[e];b.registerChromeMenu(f)}}};var c={init:function(d){d=d||{};b.widgetEventingController=d.widgetEventingController||Ozone.eventing.Widget.instance;b.widgetEventingController.registerHandler(b.channelName,function(e,i){var g=true;var h=Ozone.util.parseJson(i);var j=h.itemId!=null?h.itemId:h.id;var f=b.items[j].handler;if(f!=null&&owfdojo.isFunction(f)){g=f.apply(h.scope!=null?h.scope:window,h.args!=null?h.args:[])}return g})},isModified:function(d){var f={action:"isModified"};var e=gadgets.json.stringify(f);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),e)},addHeaderButtons:function(d){var h={};var e=null;if(!owfdojo.isArray(d.items)){e=[d.items]}else{e=d.items}h.action="addHeaderButtons";h.type="button";h.items=e;for(var g=0;g<e.length;g++){b.items[e[g].itemId!=null?e[g].itemId:e[g].id]=e[g]}var f=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),f)},updateHeaderButtons:function(d){var h={};var e=null;if(!owfdojo.isArray(d.items)){e=[d.items]}else{e=d.items}h.action="updateHeaderButtons";h.type="button";h.items=e;for(var g=0;g<e.length;g++){var j=e[g].itemId!=null?e[g].itemId:e[g].id;if(b.items[j]!=null){owfdojo.mixin(b.items[j],e[g])}else{b.items[j]=e[g]}}var f=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),f)},insertHeaderButtons:function(d){var h={};var e=null;if(!owfdojo.isArray(d.items)){e=[d.items]}else{e=d.items}h.action="insertHeaderButtons";h.type="button";if(d.pos!=null){h.pos=d.pos}h.items=e;for(var g=0;g<e.length;g++){b.items[e[g].itemId!=null?e[g].itemId:e[g].id]=e[g]}var f=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),f)},removeHeaderButtons:function(d){var h={};var e=null;if(!owfdojo.isArray(d.items)){e=[d.items]}else{e=d.items}h.action="removeHeaderButtons";h.type="button";h.items=e;for(var g=0;g<e.length;g++){var j=e[g].itemId!=null?e[g].itemId:e[g].id;if(b.items[j]!=null){delete b.items[j]}}var f=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),f)},listHeaderButtons:function(d){var f={action:"listHeaderMenus",type:"button"};var e=gadgets.json.stringify(f);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),e)},addHeaderMenus:function(d){var j={};var e=null;if(!owfdojo.isArray(d.items)){e=[d.items]}else{e=d.items}j.action="addHeaderMenus";j.type="menu";j.items=e;for(var g=0;g<e.length;g++){var h=e[g];b.registerChromeMenu(h)}var f=gadgets.json.stringify(j);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),f)},updateHeaderMenus:function(m){var h={};var n=null;if(!owfdojo.isArray(m.items)){n=[m.items]}else{n=m.items}h.action="updateHeaderMenus";h.type="menu";h.items=n;var o=function(w,s,v){if(typeof s==="string"){if(v&&v.constructor===Object){if(w[s]&&w[s].constructor===Object){o(w[s],v)}else{w[s]=Ext.clone(v)}}else{w[s]=v}return w}var k=1,t=arguments.length,j,u;for(;k<t;k++){j=arguments[k];for(u in j){if(j.hasOwnProperty(u)){o(w,u,j[u])}}}return w};for(var l=0;l<n.length;l++){var r=n[l];if(r.menu||r.handler){b.registerChromeMenu(r)}if(r.menu){for(var g=0;g<r.menu.items.length;g++){var d=r.menu.items[g];if(!d.menu){var q=d.itemId!=null?d.itemId:d.id;b.items[q]=b.items[q]?b.items[q]:{};b.items[q]=o(b.items[q],d)}else{for(var f=0;f<d.menu.items.length;f++){var e=d.menu.items[f];var q=e.itemId!=null?e.itemId:e.id;b.items[q]=b.items[q]?b.items[q]:{};b.items[q]=o(b.items[q],e)}}}}else{var q=r.itemId!=null?r.itemId:r.id;b.items[q]=b.items[q]?b.items[q]:{};b.items[q]=o(b.items[q],r)}h.items[l]=b.items[h.items[l].itemId]}var p=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,m.callback,b.widgetEventingController.getWidgetId(),p)},insertHeaderMenus:function(m){var h={};var n=null;if(!owfdojo.isArray(m.items)){n=[m.items]}else{n=m.items}h.action="insertHeaderMenus";h.type="menu";if(m.pos!=null){h.pos=m.pos}h.items=n;for(var l=0;l<n.length;l++){var p=n[l];if(p.menu){for(var g=0;g<p.menu.items.length;g++){var d=p.menu.items[g];if(!d.menu){b.items[d.itemId!=null?d.itemId:d.id]=d}else{for(var f=0;f<d.menu.items.length;f++){var e=d.menu.items[f];b.items[e.itemId!=null?e.itemId:e.id]=e}}}}else{b.items[p.itemId!=null?p.itemId:p.id]=p}}var o=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,m.callback,b.widgetEventingController.getWidgetId(),o)},removeHeaderMenus:function(d){var h={};var e=null;if(!owfdojo.isArray(d.items)){e=[d.items]}else{e=d.items}h.action="removeHeaderMenus";h.type="menu";h.items=e;for(var g=0;g<e.length;g++){var j=e[g];if(b.items[j]!=null){delete b.items[j]}}var f=gadgets.json.stringify(h);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),f)},listHeaderMenus:function(d){var f={action:"listHeaderMenus",type:"menu"};var e=gadgets.json.stringify(f);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),e)},getTitle:function(d){var f={action:"getTitle"};var e=gadgets.json.stringify(f);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),e)},setTitle:function(d){var f={action:"setTitle",title:d.title};var e=gadgets.json.stringify(f);gadgets.rpc.call("..",b.channelName,d.callback,b.widgetEventingController.getWidgetId(),e)}};c.init(a);Ozone.chrome.WidgetChrome.instance=c}return Ozone.chrome.WidgetChrome.instance};Ozone.chrome.WidgetChrome.getInstance=function(a){if(Ozone.chrome.WidgetChrome.instance==null){Ozone.chrome.WidgetChrome.instance=new Ozone.chrome.WidgetChrome(a)}return Ozone.chrome.WidgetChrome.instance};